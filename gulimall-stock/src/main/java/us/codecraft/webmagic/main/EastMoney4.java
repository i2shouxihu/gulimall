package us.codecraft.webmagic.main;

import us.codecraft.webmagic.Page;
import us.codecraft.webmagic.Request;
import us.codecraft.webmagic.Site;
import us.codecraft.webmagic.Spider;
import us.codecraft.webmagic.pipeline.ConsolePipeline;
import us.codecraft.webmagic.pipeline.FilePipeline;
import us.codecraft.webmagic.processor.PageProcessor;
import us.codecraft.webmagic.selector.JsonPathSelector;
import us.codecraft.webmagic.utils.HttpConstant;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.concurrent.ForkJoinPool;

import static java.util.Arrays.*;

//筛选出22天里最近一天最低的非机构持仓的轻度控盘或中度控盘的股票
public class EastMoney4 implements PageProcessor {

    List<String> url2s=new ArrayList<>();

    // 部分一：抓取网站的相关配置，包括编码、抓取间隔、重试次数等
    private Site site = Site.me().setCharset("utf-8").setRetryTimes(3).setSleepTime(1000);

    @Override
    // process是定制爬虫逻辑的核心接口，在这里编写抽取逻辑
    public void process(Page page) {

        String raw = String.valueOf(new JsonPathSelector("$").selectList(page.getRawText()));
        //System.out.println(raw);
        String[] split = raw.split("\\[|\\]");
        String jsonArray="{\"data\":["+split[2].toString()+"]}";
        //System.out.println(jsonArray);

        List<String> sumJGCXD = new ArrayList<>();

        for (int i = 0; i < 22; i++) {



            List<String> strings = new JsonPathSelector("$.data["+i+"].JGCYD").selectList(jsonArray);
            sumJGCXD.addAll(strings);



        }

        String[] split1 = sumJGCXD.toString().split("\\[|\\]")[1].split(",");
        float[] fsplit1=new float[split1.length];
        for (int i = 0; i < split1.length; i++) {
            fsplit1[i]=Float.parseFloat(split1[i]);
        }


        float max=fsplit1[0];//将数组的第一个元素赋给max
        float min=fsplit1[0];//将数组的第一个元素赋给min
        for(int i=1;i<fsplit1.length;i++){//从数组的第二个元素开始赋值，依次比较
            if(fsplit1[i]>max){//如果arr[i]大于最大值，就将arr[i]赋给最大值
                max=fsplit1[i];
            }
            if(fsplit1[i]<min){//如果arr[i]小于最小值，就将arr[i]赋给最小值
                min=fsplit1[i];
            }
        }
        System.out.print(new JsonPathSelector("$.data[0].STOCKNAME").selectList(jsonArray));
        System.out.print(new JsonPathSelector("$.data[0].TRADECODE").selectList(jsonArray));
        if(fsplit1[7]==min){
            System.out.print("今天的最小股票有了！！！    ");
            System.out.println(min);
        }
        if(fsplit1[1]==max){
            System.out.print("今天的最大股票有了！！！    ");
            System.out.println(max);
        }



//        if(fsplit1[3]==min){
//            System.out.println("3天后涨停");
//            System.out.println(min);
//        }
//        if(fsplit1[4]==min){
//            System.out.println("4天后涨停");
//            System.out.println(min);
//        }
//        if(fsplit1[5]==min){
//            System.out.println("5天后涨停");
//            System.out.println(min);
//        }
//        if(fsplit1[6]==max){
//            System.out.println("6天后涨停");
//            System.out.println(min);
//        }





        


        //沪市A股 1622
        //深市A股 474
        //创业板 932
        //中小板  1012









        }

    @Override
    public Site getSite() {
        return site;
    }

    public static void main(String[] args) {
        Request request = new Request();
        request.setMethod(HttpConstant.Method.GET);

        List<String> l = asList(

//1综合32
//2综合32
                "300208","002575","002447","002445","002072","000972","000839","000833","000820","000753","000652","000632","000622","000611","000587","000038","600766","600462","600382","600091","600083","600881","600807","600805","600784","600770","600676","600620","600234","600212","600070","600051",

//1自动化设备61
//2其他自动化设备16
                "301029","300802","300757","300486","300461","300400","300097","688686","688329","688312","688310","688215","688097","688003","605186","603960",
//2激光设备9
                "301021","300747","300227","300220","002008","000988","688559","688518","688025",
//2机器人16
                "300853","300607","300276","300024","002979","002747","002698","002527","000584","688255","688218","688165","688090","688017","603666","603416",
//2工控设备20
                "300484","300278","300124","300048","002975","002957","002334","002184","688777","688698","688395","688188","688160","605288","603859","603583","603283","603203","603025","603015",

//1专用设备168
//2印刷包装机械7
                "300521","300512","300509","300195","002611","002209","603901",
//2其他专用设备71
                "301013","301011","300988","300971","300902","300879","300836","300833","300823","300813","300756","300549","300540","300499","300472","300471","300415","300412","300411","300382","300293","300281","300210","300201","300151","300004","002837","002833","002816","002786","002779","002757","002690","002595","002529","002337","002111","002073","002031","002009","002006","000856","688700","688630","688529","688383","688378","688328","688128","688113","688092","688071","688022","688001","605259","603956","603895","603855","603656","603289","603159","603081","603076","603029","603011","600579","600520","600501","600499","600444","600330",
//2农用机械3
                "002890","603789","601038",
//2能源及重型设备41
                "300950","300865","300837","300480","300275","300099","300084","300023","002730","002691","002667","002651","002535","002526","002523","002490","002483","002353","002278","002204","000852","688633","688377","688121","603966","603800","603698","603169","603036","603012","601798","601717","601608","601399","601106","600980","600582","600560","600320","600262","600169",
//2楼宇设备13
                "301056","300931","300669","002960","002774","002689","002367","605286","603488","603356","603321","600894","600835",
//2工程机械21
                "301079","300718","002272","002097","000680","000528","000425","000157","688425","605389","605305","603638","603611","603338","603298","601100","600984","600817","600815","600761","600031",
//2纺织服装设备12
                "301053","300307","003036","002722","002021","688789","603337","603095","600843","600545","600302","600232",

//1专业服务21
//2专业服务21
                "300962","300942","300938","300887","300860","300797","300795","300662","300572","300416","300215","300012","003008","002967","002878","002751","603466","603183","603060","600826","600662",

//1种植业与林业22
//2种子生产8
                "300189","300087","002041","000998","000713","600371","600354","600313",
//2其他种植业9
                "300972","300970","300511","002772","600506","601118","600540","600359","600108",
//2林业3
                "002679","000592","600265",
//2粮食种植2
                "601952","600598",

//1中药70
//2中药70
                "300878","300534","300519","300391","300181","300147","300108","300039","300026","002907","002873","002864","002750","002737","002728","002644","002603","002566","002433","002424","002412","002390","002349","002317","002287","002275","002198","002166","002118","002107","002082","000999","000989","000790","000650","000590","000538","000423","600671","600518","605199","603998","603963","603896","603858","603567","603439","603139","600993","600976","600771","600750","600594","600572","600566","600557","600535","600479","600436","600422","600351","600332","600329","600285","600252","600222","600211","600129","600085","600080",

//1证券48
//2证券48
                "300059","002945","002939","002926","002797","002736","002673","002670","002500","000783","000776","000750","000728","000712","000686","000166","601995","601990","601901","601881","601878","601788","601696","601688","601555","601456","601377","601375","601236","601211","601198","601162","601108","601099","601066","600999","600958","600918","600909","600906","600864","600837","600621","600369","600155","600109","600095","600030",

//1造纸22
//2造纸22
                "002521","002235","002078","002067","002012","000815","000488","603863","605500","605377","605007","603733","603165","600966","600963","600793","600567","600433","600356","600308","600235","600103",

//1油气开采及服务20
//2油气开采6
                "300483","000968","600856","600777","600759","600256",
//2油服工程14
                "300191","300164","300157","002828","002629","002554","002207","603727","603619","601808","600968","600871","600583","600339",

//1饮料制造46
//2软饮料11
                "300997","000848","600300","605499","605388","605337","605198","603711","603156","600962","600189",
//2其他酒类9
                "002568","000869","600084","603779","601579","600616","600543","600238","600059",
//2啤酒7
                "002461","000929","000752","000729","600600","600573","600132",
//2白酒19
                "600702","600779","000799","603198","600809","002646","000568","600197","600519","600199","603919","000596","603369","000995","603589","000858","002304","600559","000860",

//1银行41
//2农商行10
                "002958","002839","002807","603323","601860","601825","601528","601128","601077","600908",
//2国有大型银行6
                "601988","601939","601658","601398","601328","601288",
//2股份制银行9
                "000001","601998","601916","601818","601166","600036","600016","600015","600000",
//2城商行16
                "002966","002948","002936","002142","601997","601963","601838","601665","601577","601229","601187","601169","601009","600928","600926","600919",

//1仪器仪表38
//2仪器仪表38
                "301129","301006","300897","300720","300667","300567","300557","300553","300515","300445","300417","300410","300371","300370","300354","300349","300341","300306","300259","300203","300165","300112","300066","300007","002849","002819","002767","002175","688768","688665","688628","688622","688528","688056","605056","603700","603662","603100",

//1医药商业27
//2医药商业27"301017","301015","300937","002788","002727","002589","002462","000950","000705","000411","000078","000028","600090","605266","603939","603883","603716","603368","603233","601607","600998","600833","600829","600713","600511","600272","600056",

//1医疗器械99
//2医疗设备27
                "301087","300869","300760","300753","300633","300562","300358","300314","300298","300273","300246","300206","300171","300049","300030","002432","002223","688677","688626","688607","688580","688358","688301","688277","688139","600587","600055",
//2医疗耗材36
                "301093","301033","300981","300677","300653","300595","300529","300453","300326","300238","300003","002950","002901","002817","002551","002382","688617","688613","688366","688314","688198","688161","688108","688085","688050","688029","688016","688013","605369","603987","603976","603880","603309","603301","603222","600529",
//2体外诊断36
                "300832","300685","300676","300642","300639","300482","300463","300439","300406","300396","300318","300289","002932","002030","002022","000710","688767","688656","688606","688575","688468","688399","688393","688389","688338","688317","688298","688289","688217","688068","688067","603658","603392","603387","600645","600538",

//1医疗服务38
//2医疗研发外包18
                "301080","301047","300759","300725","300404","300363","300347","300149","002821","600721","688621","688222","688202","688131","688076","603456","603259","603127",
//2其他医疗服务20
                "301060","300244","300143","300109","300015","002524","002219","002173","002172","002044","000516","000509","000504","000150","600896","600568","688315","603882","603108","600763",

//1养殖业27
//2水产养殖6
                "300094","002086","002069","600275","600467","600257",
//2海洋捕捞2
                "000798","600097",
//2畜禽养殖19
                "300967","300761","300498","300313","002982","002746","002714","002458","002321","002299","002234","002157","002124","001201","000735","605296","603477","600975","600965",

//1小金属35
//2稀土4
                "000831","600392","600259","600111",
//2其他小金属23
                "301026","300328","002978","002842","002738","002428","002378","002182","002167","002149","000962","000960","000657","600615","605376","603993","603663","603399","601958","600549","600459","600456","600281",
//2能源金属8
                "300618","002466","002460","002240","002192","000762","603799","600711",

//1小家电19
//2小家电19
                "300824","300272","300247","003023","002959","002705","002614","002473","002403","002242","002032","002005","688793","688169","605555","603868","603579","603486","603355",

//1消费电子80
//2消费电子零部件及组装73
                "301086","301067","301051","300976","300968","300956","300951","300916","300857","300843","300822","300793","300787","300735","300709","300686","300684","300679","300602","300543","300433","300322","300279","300256","300136","300131","300115","300032","003028","002993","002981","002976","002947","002937","002925","002885","002881","002866","002861","002855","002782","002681","002660","002655","002635","002600","002547","002475","002402","002369","002241","002188","002139","002055","000021","600898","688683","688678","688661","688260","605277","603890","603629","603626","603595","603380","603327","603133","601231","601138","600745","600203","600130",
//2品牌消费电子7
                "300866","002888","002351","002045","603996","688036","688007",

//1物流45
//2物流45
                "300873","300240","300013","002930","002889","002800","002769","002682","002492","002468","002352","002183","002120","002010","001202","000927","000906","605050","603967","603871","603836","603813","603713","603648","603569","603535","603329","603223","603128","603117","603066","603056","601598","601156","600794","600787","600755","600753","600704","600233","600180","600179","600153","600119","600057",

//1通用设备141
//2制冷空调设备12
                "301018","300990","002686","002639","002158","000811","000530","603912","603339","603277","603187","600481",
//2其他通用设备36
                "301083","301070","301043","301032","301028","300992","300984","300503","300470","300441","300430","300420","300263","300257","300193","300154","300145","300126","300091","002884","002598","002444","001696","688596","688557","688360","688211","605060","603757","603617","603331","603269","603131","603090","601369","600243",
//2磨具磨料14
                "301071","300861","300818","300700","300606","300554","300345","300179","300064","002760","002282","002046","688028","600172",
//2金属制品60
                "300985","300953","300946","300943","300885","300838","300828","300817","300780","300488","300421","300402","300228","300095","300092","002965","002931","002896","002877","002871","002843","002795","002633","002552","002514","002480","002438","002426","002347","002342","002164","002150","002132","002122","002026","000890","000777","000595","000039","688379","688355","688308","688257","688059","605100","603969","603915","603699","603667","603308","603278","603028","601177","601002","600992","600860","600592","600558","600421","600114",
//2机床工具19
                "300809","300161","300083","003025","002943","002903","002685","002559","002520","002248","000837","000410","688697","688577","688558","688333","688305","603088","601882",

//1通信设备107
//2通信终端及配件36
                "300689","300638","300628","300615","300590","300555","300504","300205","003040","003031","002908","002313","002104","002017","000032","600734","688159","688100","688027","603803","603236","603118","603083","600775","600355",
//2通信线缆及配套29
                "300913","300563","002491","000836","000586","000070","603042","601869","600522","600487","600105",
//2通信网络设备及器件32
                "300710","300698","300620","300570","300565","300548","300502","300394","300312","300308","300134","002902","002897","002796","002792","002583","002396","002296","002281","002211","002194","002089","000851","000063","688668","688618","688313","603421","600498",
//2其他通信设备10
                "300711","300414","300353","300213","300183","600260","688418","688080","600776","600345",

//1通信服务32
//2通信服务32
                "300959","300921","300603","300597","300578","300560","300513","300310","300292","300211","300113","300081","300050","300025","002929","002544","002467","002231","002148","002123","002115","002093","000971","000889","600289","603602","603559","603322","603220","601728","600804","600050",

//1食品加工制造71
//2休闲食品20
                "300973","300783","003000","002991","002956","002847","002820","002695","002582","002557","001219","000716","605339","603886","603866","603777","603719","603697","603517","603043",
//2乳品18
                "300915","300898","300892","300106","002946","002910","002770","002732","002719","002570","002329","605300","605179","600887","600882","600597","600429","600419",
//2肉制品7
                "002840","002726","002515","002330","000895","605567","600073",
//2其他食品13
                "300791","300146","002702","002626","002216","001215","000639","605338","605089","603536","603345","600530","600381",
//2调味发酵品13
                "300908","002650","002507","002495","603755","603696","603317","603288","603027","600872","600305","600298","600186",

//1石油加工贸易24
//2油品石化贸易5
                "000554","000159","000096","600387","603353",
//2石油加工19
                "300839","300135","002986","002648","002493","002476","002408","002221","000985","000819","000698","000637","000059","603798","601857","600800","600688","600346","600028",

//1生物制品40
//2疫苗10
                "300841","300601","300142","300122","688739","688670","688319","688276","688185","600739",
//2血液制品6
                "300294","002880","002252","002007","000403","600161",
//2其他生物制品24
                "300683","300485","300357","300239","300204","300009","002693","002581","002038","000661","000534","000518","688687","688520","688488","688336","688278","688180","688177","688136","603590","603087","600867","600682",

//1燃气27
//2燃气27
                "300435","300332","002911","002700","002267","002259","000669","000593","000421","000407","605368","605169","605090","603706","603689","603393","603318","603080","603053","601139","600917","600903","600803","600681","600635","600617","600333",

//1汽车整车23
//2商用载客车6
                "000957","000868","600686","600303","600213","600066",
//2商用载货车8
                "301039","000951","000800","000550","600418","600375","600166","600006",
//2乘用车9
                "002594","000980","000625","000572","601633","601238","601127","600733","600104",

//1汽车零部件177
//2汽车零部件177
                "301072","301022","301020","301007","301005","301000","300998","300978","300969","300928","300926","300912","300893","300863","300816","300745","300742","300733","300707","300695","300694","300681","300680","300652","300643","300611","300585","300580","300547","300507","300473","300432","300428","300375","300304","300258","300176","300100","002997","002984","002921","002906","002870","002865","002863","002813","002766","002725","002715","002708","002703","002664","002662","002592","002590","002553","002537","002536","002516","002510","002488","002472","002454","002448","002434","002406","002363","002355","002328","002284","002283","002265","002239","002126","002101","002085","002048","000981","000903","000901","000887","000880","000816","000700","000678","000599","000589","000581","000570","000559","000338","000030","600182","688737","688667","688533","688280","688021","605333","605319","605255","605228","605133","605128","605088","605068","605018","605005","603997","603982","603950","603949","603926","603922","603917","603809","603788","603786","603768","603767","603758","603730","603701","603655","603633","603596","603586","603390","603358","603348","603335","603319","603306","603305","603286","603239","603197","603179","603178","603166","603161","603158","603121","603109","603089","603085","603040","603037","603035","603023","603013","603009","603006","601966","601799","601689","601500","601279","601163","601058","600960","600933","600841","600742","600741","600699","600698","600660","600626","600609","600523","600480","600469","600218","600178","600148","600081",

//1汽车服务14
//2汽车服务14
                "300825","002758","002684","000996","000757","000025","605151","601965","601258","600822","600653","600386","600335","600297",

//1其他社会服务3
//2体育3
                "002858","600158","600136",

//1其他电子31
//2其他电子31
                "301031","300991","300975","300868","300736","300656","300516","300493","300475","300390","300184","002922","002869","002859","002729","002724","002388","002213","002161","002141","002130","000701","000062","688800","688662","688103","688093","603933","600751","600353","600288",

//1农业服务13
//2农业综合2
                "300021","002556",
//2动物保健11
                "300871","300119","002868","002688","688526","688098","603739","603718","603566","600201","600195",

//1农产品加工33
//2饲料14
                "300673","002891","002696","002567","002548","002385","002311","002100","000876","000702","000048","603668","603609","603363",
//2其他农产品加工10
                "300268","300138","003030","002661","002481","002286","000930","000911","600191","600737",
//2粮油加工6
                "300999","002852","000505","000019","600811","600127",
//2果蔬加工3
                "300175","603336","600251",

//1美容护理29
//2医疗美容3
                "300896","000615","688363",
//2化妆品13
                "300957","300955","300886","300856","300849","300740","300132","002243","002094","603983","603630","603605","600315",
//2个护用品13
                "301059","301009","300658","003006","002919","002511","001218","001206","000523","605009","603238","603059","600249",

//1煤炭开采加工34
//2煤炭开采26
                "002128","000983","000937","000780","000571","000552","600403","601918","601898","601699","601666","601225","601101","601088","601001","600985","600971","600758","600546","600508","600397","600395","600348","600188","600123","600121",
//2焦炭加工8
                "000723","600408","603113","601015","601011","600997","600792","600740",

//1贸易19
//2贸易19
                "002505","002091","000626","000151","600870","600608","600301","600145","601028","600981","600725","600710","600647","600532","600287","600278","600250","600128","600058",

//1零售78
//2专业连锁10
                "301078","300755","300622","300022","002416","000829","600365","600122","603214","600696",
//2商业物业经营18
                "300947","002818","002344","000882","000861","000785","000061","000058","000056","000007","603682","601828","600790","600738","600655","600605","600415","600113",
//2旅游零售1
                "601888",
//2百货零售49
                "002697","002561","002419","002356","002336","002277","002264","002251","002187","000759","000715","000679","000564","000501","000419","000417","600306","605188","603708","603123","603101","603031","601933","601366","601116","601086","601010","600865","600861","600859","600858","600857","600838","600828","600827","600824","600814","600785","600778","600729","600723","600712","600697","600694","600693","600628","600361","600327","600280",

//1酒店及餐饮11
//2酒店7
                "301073","000613","000610","000428","601007","600754","600258",
//2餐饮4
                "002306","002186","000721","605108",

//1景点及旅游22
//2自然景点11
                "300859","002159","002033","000978","000888","000430","603199","603136","603099","600749","600054",
//2人工景点5
                "300144","002485","002059","600593","600706",
//2旅游综合6
                "300178","002707","000796","000524","600555","600138",

//1金属新材料22
//2其他金属新材料11
                "300963","300930","300855","000969","000633","688786","688269","603978","603045","601137","600255",
//2磁性材料11
                "300835","300811","300748","300224","300127","002057","002056","000970","000795","688077","600366",

//1教育21
//2教育21
                "300688","300359","300338","300282","300192","300089","300010","003032","002659","002638","002621","002607","002261","000526","605098","603377","600880","600730","600661","600636","600455",

//1建筑装饰137
//2装饰园林43
                "300949","300649","300621","300592","300536","300506","300237","002989","002963","002856","002830","002822","002811","002789","002781","002775","002713","002663","002620","002504","002482","002431","002375","002325","002200","002081","002047","000010","603007","600209","605303","605289","605287","605178","603955","603828","603778","603717","603388","603316","603030","601886","600193",
//2专业工程28
                "301046","300517","300384","300117","003001","002743","002593","002542","002541","002140","002135","002051","000928","000065","605598","605167","603979","603959","603929","603637","603098","601618","601226","601117","601068","600970","600496","600477",
//2基础建设26
                "300982","300712","002941","002628","002586","002564","002307","002062","002061","002060","000498","603843","603815","601868","601800","601669","601611","601390","601186","600853","600820","600512","600502","600284","600133","600039",
//2工程咨询服务32
                "301091","301058","301038","301027","301024","300989","300983","300977","300844","300826","300778","300746","300732","300675","300668","300635","300564","300500","300492","300284","003013","002949","002883","002116","000779","603909","603860","603458","603357","603018","603017","600629",
//2房屋建设8
                "002761","000628","601789","601668","600939","600491","600248","600170",

//1建筑材料77
//2水泥27
                "003037","002742","002671","002596","002302","002233","000935","000877","000789","000672","000546","000401","000023","605122","603616","601992","600883","600802","600801","600724","600720","600678","600668","600585","600449","600425","600326",
//2其他建材24
                "301010","300737","300715","300374","300234","002791","002785","002718","002652","002398","002333","002323","002271","002247","002043","001212","000786","000619","000055","605318","603737","603378","603038","600321",
//2耐火材料4
                "002392","002225","002088","002066",
//2管材7
                "300599","300198","002694","002641","002457","002372","603856",
//2玻璃玻纤15
                "300196","300093","002613","002201","002163","002080","000012","605006","603601","603256","601636","600819","600586","600293","600176",

//1家用轻工84
//2文娱用品12
                "300703","300651","300329","002899","002862","002678","002348","002301","002103","605299","603899","603398",
//2饰品14
                "300945","002867","002740","002731","002721","002574","002345","000026","605599","603900","600916","600735","600612","600439",
//2其他家用轻工22
                "301055","301004","300993","300729","300640","002790","002615","002571","002084","001216","001211","600599","605155","605099","603992","603838","603615","603408","603385","603268","603195","603021",
//2家具26
                "301061","300749","300616","002853","002631","002572","002489","000663","605268","603898","603848","603833","603818","603816","603801","603709","603661","603610","603600","603389","603326","603313","603208","603180","603008","600337",
//2瓷砖地板10
                "003012","003011","002918","002798","002162","000910","603226","603221","601996","600076",

//1计算机应用213
//2软件开发104
                "300996","300935","300925","300830","300803","300799","300768","300730","300663","300624","300608","300605","300598","300579","300561","300559","300556","300550","300542","300525","300520","300469","300468","300465","300454","300451","300380","300379","300378","300377","300369","300366","300365","300352","300348","300344","300311","300271","300253","300235","300229","300226","300188","300098","300085","300075","300074","300047","300036","300033","003029","003007","002987","002920","002439","002410","002405","002362","002322","002298","002279","002253","002230","002212","002178","002153","002063","000948","000503","000004","600654","688590","688588","688579","688561","688555","688369","688318","688296","688201","688168","688118","688111","688109","688095","688083","688078","688058","688038","688030","688023","603990","603927","603528","603383","603232","603189","603039","601519","601360","600767","600602","600588","600570",
//2IT服务109
                "688509","002453","300339","603171","600225","688787","300350","300682","300079","300687","300264","688568","600845","000938","600571","002649","000409","300290","600850","002642","000158","300288","300167","300496","300300","002368","688039","300287","300250","300419","300541","002609","600728","605398","603138","603869","300440","002421","300738","300020","300212","300277","603003","002771","600131","300895","300096","600271","600476","300150","002474","300532","300634","002195","603636","300231","002777","002657","002380","300170","002232","300245","600718","600797","603918","688316","002065","300248","300674","002401","300166","688500","300017","300609","300678","000555","000638","002331","600756","002530","688158","600446","300383","300872","002373","300448","603881","600410","300078","688004","300297","688228","000034","300523","300399","002417","003005","688258","000606","600536","688051","300168","603887","688088","688229","688365","300846","300044","301085",

//1计算机设备69
//2计算机设备69
                "301042","300941","300884","300845","300807","300790","300789","300771","300743","300691","300659","300645","300588","300552","300551","300546","300531","300508","300479","300462","300455","300449","300386","300368","300367","300333","300330","300324","300302","300270","300249","300202","300155","300130","300042","003004","002990","002970","002912","002835","002577","002528","002512","002415","002376","002308","002268","002236","002197","002180","002177","002152","000997","000977","000066","688619","688288","688208","688086","688060","605118","603660","603516","603508","603496","603106","603019","600855","600100",

//1机场航运12
//2机场4
                "000089","600897","600009","600004",
//2航空运输8
                "002928","000099","600221","603885","601111","601021","600115","600029",

//1环保119
//2大气治理6
                "300072","003027","002573","603315","603177","600292",
//2固废治理26
                "301068","301049","300867","300854","300815","300779","300614","300187","300103","002973","002672","002266","002210","002034","000803","000035","688679","688156","603588","603568","603126","601827","601330","601200","600323","600217",
//2环保设备22
                "301081","301030","300862","300800","300786","300631","300385","300140","300137","002658","002645","000967","000551","688600","688501","688335","688309","603686","603324","603279","600526","600388",
//2水务及水治理41
                "300961","300929","300899","300774","300692","300664","300425","300422","300388","300262","300172","300070","300055","003039","000920","000685","000605","000598","000544","688565","688466","688101","688096","688069","688057","605081","603903","603817","603797","603759","603603","603200","601368","601199","601158","600874","600769","600461","600283","600187","600168",
//2综合环境治理24
                "300958","300948","300864","300495","300355","300266","300197","300190","300152","300056","002887","002778","002717","002310","002205","000826","000711","000068","000005","688701","688178","605069","603359","600008",

//1化学制药131
//2化学制剂97
                "301075","300723","300705","300630","300584","300573","300558","300436","300434","300255","300254","300233","300199","300194","300158","300111","300110","300086","300016","300006","003020","002940","002923","002900","002898","002872","002826","002793","002773","002755","002675","002653","002550","002437","002435","002422","002411","002393","002370","002332","002294","002262","002020","002019","002004","000963","000931","000919","000915","000908","000813","000788","000766","000623","000597","000566","000513","000153","600781","688799","688658","688578","688566","688553","688513","688505","688321","688266","688221","688189","688117","688091","603811","603707","603676","603669","603367","603168","600851","600812","600789","600774","600673","600664","600624","600613","600521","600513","600488","600420","600380","600276","600227","600200","600196","600079","600062",
//2原料药34
                "301089","301065","300966","300765","300702","300636","300583","300497","300452","300401","300381","300267","002399","002365","002102","002099","002001","000953","000952","000756","000739","600385","688690","688356","688166","605507","605177","605116","603538","603520","603351","603229","600267","600216",

//1化学制品184
//2氮肥3
                "000912","000731","600691",
//2纺织化学用品11
                "300905","300798","300107","300067","002440","002054","605566","603980","603790","603188","600352",
//2氟化工9
                "300343","002915","002407","002326","605020","603505","603379","600378","600160",
//2复合肥9
                "300387","002999","002588","002539","002538","002470","002274","002170","000902",
//2钾肥5
                "002545","000893","000792","000408","603938",
//2聚氨酯7
                "300848","300200","002165","603192","603041","600309","600230",
//2磷肥及磷化工8
                "300505","002895","002312","000422","600078","600470","600141","600096",
//2民爆用品13
                "003002","002917","002827","002783","002683","002497","002360","002246","002226","002096","002037","603977","603227",
//2农药28
                "301035","300796","300575","300261","003042","002942","002749","002734","002513","002496","002391","002258","002250","002215","000553","000525","605033","603970","603810","603639","603599","603585","603360","603086","600796","600731","600486","600389",
//2其他化学制品53
                "301077","301076","300910","300847","300801","300721","300646","300641","300610","300596","300535","300530","300437","300405","300285","300174","300169","300163","002971","002810","002809","002802","002669","002666","002637","002549","002455","002430","000881","000691","688659","688625","688398","688350","688199","688196","688179","688133","688065","603948","603916","603906","603867","603822","603725","603683","603681","603217","603181","600727","600500","600273","600165",
//2食品及饲料添加剂15
                "300858","300829","300741","002597","002562","688639","688089","605077","605016","603968","603079","603020","600873","600866","600299",
//2有机硅10
                "300821","300727","300041","300019","002909","605399","605366","603260","603155","600596",
//2涂料油墨13
                "301037","301036","300758","300665","300522","300225","002319","000565","688571","688157","688129","603823","603110",

//1化学原料51
//2纯碱5
                "000822","000707","000683","603077","600409",
//2氯碱14
                "002748","002386","002092","002002","000818","000635","000510","600319","601678","601568","601216","600618","600277","600075",
//2其他化学原料17
                "301069","300927","300082","002469","002109","001217","000990","000830","600989","600955","600844","600746","600722","600623","600610","600426","600423",
//2钛白粉5
                "300891","002601","002145","002136","000545",
//2无机盐10
                "003017","002125","002053","000737","603299","603067","600929","600714","600367","600328",

//1化工合成材料102
//2涤纶13
                "301090","301057","002998","002427","002206","000936","000703","000677","000301","603332","603225","601233","600370",
//2改性塑料15
                "301003","300995","300716","300644","300586","300538","300478","300221","002886","002838","002768","002324","688669","688219","600143",
//2合成树脂8
                "301092","300487","002395","002361","688585","605589","603928","603879",
//2膜材料15
                "300806","300334","300305","002632","002585","002522","002341","002263","000973","000859","688718","688386","688323","601208","600135",
//2其他塑料制品26
                "301019","300980","300920","300717","300539","300325","300321","300243","300230","300218","300214","300180","002825","002108","600589","688087","688026","605488","605008","603991","603722","603580","603330","603266","603010","603002",
//2其他纤维6
                "300876","000782","688722","605166","600810","600063",
//2其他橡胶制品9
                "300767","300731","300587","300320","300121","002381","002224","603650","603033",
//2炭黑5
                "002753","002442","002068","001207","605183",
//2粘胶2
                "000420","600889",
//2氨纶3
                "000949","002254","002064",

//1互联网电商15
//2互联网电商15
                "301001","300792","300464","300209","003010","002803","002640","002315","002280","002127","002024","601113","605136","603613","600539",

//1黑色家电11
//2彩电4
                "002429","000016","600839","600060",
//2其他黑色家电7
                "002848","002519","002052","000810","000801","688696","688609",

//1国防军工113
//2地面兵装9
                "300922","300875","300527","000576","000519","601606","600967","600435","600184",
//2航天装备8
                "300722","003009","002829","688066","601698","600879","600343","600118",
//2航空装备41
                "300965","300900","300777","300775","300719","300699","300696","300581","300424","300397","300395","300159","300034","002985","002933","002625","002389","002297","002190","002023","002013","000768","000738","000697","000687","000561","688685","688586","688510","688239","688122","688070","605123","600893","600862","600765","600760","600391","600372","600316","600038",
//2航海装备12
                "300810","300600","300589","300065","300008","601989","601890","600764","600685","600482","600150","600072",
//2军工电子43
                "301050","300762","300726","300629","300627","300474","300447","300252","300177","300123","300114","300101","300045","002977","002935","002465","002446","002414","002413","002383","002338","002214","002189","002179","002151","002025","000733","000547","688788","688776","688682","688636","688511","688311","688272","688081","688011","688002","603712","603678","603267","600990","600562",

//1贵金属10
//2贵金属10
                "002716","002237","002155","000975","000506","600311","601069","600988","600547","600489",

//1光学光电子95
//2光学元件16
                "301045","300701","300566","003015","002962","002808","002456","002273","002222","688195","688127","688079","688010","605588","603297","600071",
//2面板39
                "300939","300909","300545","300331","300128","300120","300088","300076","003019","002992","002955","002952","002876","002845","002841","002765","002387","002289","002217","002106","002036","000727","000725","000536","000413","000100","000050","000045","000020","600666","688538","688299","688181","688055","605218","603773","603703","600707","600552",
//2LED40
                "301002","300940","300582","300162","603303","300296","002723","300102","300708","300650","300241","600703","300303","600261","600363","300219","605365","002076","300323","603685","002745","300632","300625","002449","002654","000541","300232","600651","002137","300752","002983","300808","300269","002587","300389","300647","603515","300301","603679","300889",

//1公路铁路运输36
//2高速公路21
                "001965","000900","000885","000828","000755","000548","000429","000088","601518","601188","601107","600548","600377","600368","600350","600269","600106","600035","600033","600020","600012",
//2公交8
                "002627","002357","603032","603069","600834","600650","600611","600561",
//2铁路运输7
                "001213","000557","601816","601333","601006","600575","600125",

//1工业金属59
//2铝30
                "300986","300489","300337","300057","003038","002996","002988","002824","002806","002578","002540","002532","002501","002379","002160","000933","000807","000612","600595","605208","603937","603876","603115","601702","601677","601600","601388","600888","600768","600219",
//2铅锌14
                "002114","000758","000751","000688","000603","000426","000060","601020","601168","600961","600531","600497","600338","600331",
//2铜15
                "300697","002295","002203","002171","000878","000630","688456","688388","603527","601899","601609","601212","600490","600362","600110",

//1港口航运29
//2航运12
                "002320","001205","000520","603565","603167","601975","601919","601872","601866","600798","600428","600026",
//2港口17
                "002040","001872","000905","000582","000507","601880","601326","601298","601228","601018","601008","601000","600717","600279","600190","600018","600017",

//1钢铁44
//2普钢24
                "002110","000959","000932","000898","000778","000761","000717","000709","605158","603878","601686","601005","601003","600808","600782","600581","600569","600307","600282","600231","600126","600022","600019","600010",
//2冶钢原料7
                "001203","000923","000655","000629","601969","600516","600295",
//2特钢13
                "300881","002756","002478","002443","002318","002075","000825","000708","688186","603995","600507","600399","600117",

//1服装家纺62
//2鞋帽及其他17
                "300952","300901","300591","300526","002763","002634","603557","605080","603958","603908","603665","603608","603558","603511","603116","603001","600137",
//2家纺6
                "003041","002397","002327","002293","605003","603365",
//2服装39
                "301088","300918","300840","300005","003016","002875","002832","002780","002776","002762","002687","002656","002612","002569","002563","002503","002494","002269","002193","002154","002029","001209","603555","603157","600146","605138","603877","603839","603808","603587","603518","603196","601718","601566","600630","600400","600398","600177","600107",

//1非汽车交运43
//2轨交设备28
                "301048","301016","300960","300923","300906","300851","300594","300351","300011","002972","000976","000925","000008","688569","688367","688285","688187","688033","688015","688009","605298","605001","603680","603500","603111","601766","600528","600495",
//2其他交运设备15
                "300994","003033","002105","000913","000017","689009","603787","603776","603766","603529","603129","601777","600818","600679","600099",

//1非金属材料6
//2非金属材料6
                "688357","688300","605086","603826","603688","603612",

//1纺织制造34
//2辅料3
                "002674","002098","002003",
//2棉纺8
                "002394","002087","002083","002042","000850","000726","601339","600493",
//2印染4
                "605189","605055","600987","600448",
//2其他纺织19
                "301066","300979","300888","300877","300819","300577","002486","002404","002144","000982","000955","605180","603889","603055","601599","600689","600527","600220","600156",

//1房地产开发112
//2产业地产11
                "000720","601512","600895","600848","600658","600648","600639","600604","600463","600340","600082",
//2商业地产9
                "002305","001979","000608","000069","000031","600890","601155","600663","600007",
//2住宅开发92
                "002314","002244","002208","002147","002146","002133","002016","000965","000961","000926","000918","000909","000897","000886","000863","000838","000809","000797","000736","000732","000718","000671","000668","000667","000656","000631","000620","000616","000609","000573","000558","000540","000537","000517","000514","000402","000090","000042","000036","000029","000014","000011","000006","000002","600515","600393","600239","601588","600846","600823","600791","600773","600748","600743","600736","600716","600708","600692","600684","600683","600675","600665","600657","600649","600641","600638","600622","600606","600603","600565","600533","600510","600503","600466","600383","600376","600325","600322","600266","600246","600223","600215","600208","600185","600173","600162","600159","600094","600077","600067","600064","600048",

//1房地产服务8
//2房地产服务8
                "300917","002968","002377","002285","001914","000560","000502","603506",

//1电子化学品22
//2电子化学品22
                "300655","300637","300576","300537","300481","300446","300429","300398","300346","300236","300054","002741","002643","002584","688550","688359","688268","688106","688020","688019","603931","603078",

//1电力设备279
//2电气自控设备37
                "300882","300880","300514","300510","300490","300466","300427","300407","300360","300356","300286","300222","300040","300018","002980","002857","002546","002339","002169","002121","002090","002058","000682","000400","688681","688616","688611","688597","688330","688191","603556","603050","601567","601126",
                "600590","600406","600268",
//2风电设备21
                "301063","301040","300850","300772","300690","300569","300443","300185","300129","002531","002487","002202","688660","603985","603507","603218","603063","601615","601218","600458","600416",
//2电机19
                "301023","300907","300660","300626","003021","002892","002823","002801","002576","002249","002196","002176","000922","603988","603819","603728","603489","603320","600580",
//2电池58
                "300919","300890","300769","300750","300648","300619","300568","300457","300450","300438","300409","300340","300207","300173","300116","300073","300068","300037","300035","300014","002850","002812","002805","002759","002733","002709","002580","002340","002245","002074","000049","000009","600241","688819","688779","688778","688772","688733","688707","688567","688499","688345","688339","688155","688148","688116","688063","688006","688005","605378","603659","603026","601311","600884","600877","600847","600478","600152",
//2光伏设备44
                "300842","300827","300776","300763","300751","300724","300393","300316","300274","300125","300118","300080","300029","003022","002623","002610","002506","002459","002309","002218","002129","000821","688680","688599","688598","688560","688556","688516","688408","688390","688303","603806","603628","603396","603212","603185","601865","601012","600876","600732","600537","600438","600207","600151",
//2其他电源设备25
                "300870","300820","300713","300693","300593","300491","300376","300153","300105","002851","002665","002630","002534","002518","002366","002364","002335","002255","002227","688551","601727","600875","600475","600405","600202",
//2输变电设备44
                "301012","300932","300670","300477","300444","300423","300283","300141","300062","300001","002927","002706","002622","002452","002441","002358","002350","002346","002270","002112","002028","000806","000585","000533","600290","600112","688676","688663","688517","605066","603861","603829","603016","601877","601616","601179","600885","600550","600525","600468","600379","600312","600192","600089",
//2线缆部件及其他31
                "301082","300933","300617","300265","300069","002953","002882","002879","002692","002606","002560","002533","002498","002471","002451","002300","002276","001208","688226","605222","605196","603897","603618","603606","603577","603530","603333","601700","600973","600869","600577",

//1电力91
//2电能综合服务13
                "003035","000883","000875","600995","600979","600969","600644","600505","600483","600452","600310","600116","600101",
//2火电27
                "002608","001896","000966","000899","000767","000690","000600","000543","000539","000531","000027","601991","600863","600795","600780","600744","600726","600642","600578","600509","600396","600157","600098","600027","600023","600021","600011",
//2热力16
                "300335","002893","002479","002015","001210","000692","000037","600226","605580","605162","605028","605011","600982","600719","600167","600149",
//2水电11
                "002039","000993","000791","000722","000601","600900","600886","600868","600674","600236","600025",
//2新能源发电24
                "300317","300139","003816","002617","002616","002499","002256","000862","000591","000155","000040","603693","603105","601985","601908","601778","601619","601222","601016","600956","600905","600821","600163","600032",

//1传媒138
//2出版26
                "301052","301025","300788","300654","002181","000793","000719","000529","605577","603999","603096","601999","601949","601928","601921","601900","601858","601811","601801","601098","601019","600825","600757","600551","600373","600229",
//2广告营销31
                "300805","300781","300766","300612","300392","300336","300280","300242","300071","300063","300061","300058","300038","002995","002712","002591","002400","002291","002131","002027","000676","000607","603729","600242","605168","603825","603598","600986","600556","600358","600088",
//2数字媒体13
                "300987","300785","300571","300413","300364","300295","002095","000681","603888","603533","603000","600640","600228",
//2游戏34
                "300533","300518","300494","300467","300459","300418","300315","300299","300148","300052","300051","300043","300031","300002","002624","002619","002605","002602","002558","002555","002517","002502","002464","002425","002354","002174","002168","002113","000835","600652","603444","603258","600892","600633",
//2影视院线22
                "300528","300426","300291","300251","300182","300133","300027","002905","002739","002699","002343","002292","000892","000802","000673","603721","603103","601595","600977","600715","600576","600052",
//2有线电视网络12
                "300770","002238","000917","000665","000156","601929","600996","600959","600936","600831","600637","600037",

//1厨卫电器9
//2厨卫电器9
                "300911","300894","002677","002543","002508","002035","605336","603551","603366",

//1保险及其他33
//2多元金融33
                "300773","300309","002961","002647","002423","002316","000987","000958","000666","000617","000567","000563","000532","000416","000415","000046","600816","600695","600139","600093","603300","603093","600901","600830","600783","600705","600643","600517","600390","600318","600120","600061","600053",

//1保险7
//2保险7
                "000627","600291","601628","601601","601336","601319","601318",

//1包装印刷39
//2印刷5
                "002599","002229","002117","000695","600836",
//2包装34
                "301062","300883","300501","300442","300260","003018","003003","002969","002951","002846","002836","002831","002799","002787","002752","002735","002701","002565","002374","002303","002228","002191","002014","000812","000659","603687","603607","603499","603429","603058","603022","601968","601515","600210",

//1半导体及元件123
//2半导体设备8
                "300812","300604","003043","002371","688200","688037","688012","603690",
//2半导体材料10
                "300706","300666","003026","002409","002119","688233","688138","688126","605358","600206",
//2被动元件11
                "300460","300408","300319","002484","002199","002138","000636","603989","603738","600563","600237",
//2分立器件11
                "300831","300623","300373","300046","002079","688711","688689","605111","603290","600460","600360",
//2印制电路板35
                "301041","300964","300936","300903","300852","300814","300739","300657","300476","002938","002916","002913","002815","002636","002618","002579","002463","002436","002384","002288","002134","000823","600601","688655","688519","688183","605258","605058","603936","603920","603386","603328","603228","603186","600183",
//2集成电路制造3
                "300456","688981","688396",
//2集成电路设计37
                "300782","300672","300671","300661","300613","300458","300327","300223","300077","300053","002049","600198","688798","688766","688728","688699","688608","688601","688595","688589","688536","688521","688508","688385","688368","688286","688256","688123","688099","688018","688008","603986","603893","603501","603160","603068","600171",
//2集成电路封测8
                "002185","002156","002077","688216","688135","603005","600667","600584",

//1白色家电32
//2其他白色家电23
                "301008","300403","300342","300217","300160","002860","002676","002420","002418","002290","002050","002011","000404","605117","603726","603677","603657","603578","603519","603311","603112","601956","600619",
//2空调4
                "000921","000651","000333","600854",
//2冰洗5
                "002668","000521","600983","600690","600336"




                
        );

























        for (String t:l){
            StringBuilder s=new StringBuilder("http://dcfm.eastmoney.com/em_mutisvcexpandinterface/api/js/get?type=QGQP_LSJGCYD&token=70f12f2f4f091e459a279469fe49eca5&ps=22&filter=(TRADECODE=%27");
            s.append(t);
            s.append("%27)&st=TRADEDATE&sr=-1&callback=jQuery112307965527139220383_1617014060178&_=1617014060179");
            System.out.println(s);
            request.setUrl(s.toString());

            Spider.create(new EastMoney4())
                    //从"https://github.com/code4craft"开始抓
                    .addRequest(request)
                    .addPipeline(new FilePipeline("D:/data"))
                    .addPipeline(new ConsolePipeline())
                    //开启5个线程抓取
                    .thread(20)
                    //启动爬虫
                    .run();

        }
    }
}
